<div class="dialog-container">
    <div class="dialog-container">
        <div class="dialog-header">
            <h2 mat-dialog-title>
                <mat-icon class="header-icon">lock_reset</mat-icon>
                Recuperar Contraseña
            </h2>
            <button mat-icon-button mat-dialog-close class="close-button">
                <mat-icon>close</mat-icon>
            </button>
        </div>

        <mat-dialog-content>
            @if (!isSuccess()) {
            <div class="dialog-content">
                <p class="description">
                    Ingresa tu correo electrónico y te enviaremos un enlace para restablecer tu contraseña.
                </p>

                <form [formGroup]="forgotPasswordForm" (ngSubmit)="onSubmit()" class="forgot-form">
                    <mat-form-field appearance="outline" class="full-width">
                        <mat-label>Correo Electrónico</mat-label>
                        <input matInput formControlName="email" placeholder="usuario@empresa.com" type="email"
                            autocomplete="email">
                        <mat-icon matSuffix>email</mat-icon>
                        <mat-error>{{ getEmailError() }}</mat-error>
                    </mat-form-field>

                    @if (error()) {
                    <div class="error-message">
                        <mat-icon>error</mat-icon>
                        {{ error() }}
                    </div>
                    }
                </form>
            </div>
            } @else {
            <div class="success-content">
                <div class="success-icon">
                    <mat-icon>check_circle</mat-icon>
                </div>
                <h3>¡Correo Enviado!</h3>
                <p>
                    Se ha enviado un enlace de recuperación a tu correo electrónico.
                    Revisa tu bandeja de entrada y sigue las instrucciones.
                </p>
                <p class="note">
                    Si no encuentras el correo, revisa tu carpeta de spam.
                </p>
            </div>
            }
        </mat-dialog-content>

        <mat-dialog-actions align="end">
            @if (!isSuccess()) {
            <button mat-button type="button" (click)="onClose()" class="btn-cancel btn">
                Cancelar
            </button>
            <button mat-button type="submit" (click)="onSubmit()" [disabled]="forgotPasswordForm.invalid || isLoading()"
                class="btn btn-confirm">

                @if (isLoading()) {
                <span class="btn-content">
                    <mat-progress-spinner diameter="16" mode="indeterminate" class="spinner" strokeWidth="3">
                    </mat-progress-spinner>
                    <span>Enviando...</span>
                </span>
                } @else {
                Enviar Enlace
                }
            </button>
            } @else {
            <button mat-button (click)="onClose()" class="btn btn-confirm">
                Entendido
            </button>
            }
        </mat-dialog-actions>
    </div>